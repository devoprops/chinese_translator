import requests
from typing import Dict, List
import json

class TranslationService:
    def __init__(self):
        # Keep some common phrases for quick access
        self.common_phrases = {
            '轉法輪': 'Zhuan Falun',
            '第一講': 'Lecture One',
            '李洪志': 'Li Hongzhi',
            '法輪大法': 'Falun Dafa'
        }
        
        # Google Translate API endpoint (free tier)
        self.translate_url = "https://translate.googleapis.com/translate_a/single"
    
    def translate(self, text: str) -> str:
        """Translate Chinese text to English using Google Translate API"""
        try:
            # Check for common phrases first
            if text in self.common_phrases:
                return self.common_phrases[text]
            
            # Use Google Translate API for dynamic translation
            result = self._google_translate(text)
            print(f"Google Translate result: {result}")
            return result
            
        except Exception as e:
            print(f"Translation failed, using fallback: {e}")
            # Fallback to basic character translation if API fails
            return self._fallback_translation(text)
    
    def _google_translate(self, text: str) -> str:
        """Translate using Google Translate API"""
        try:
            params = {
                'client': 'gtx',
                'sl': 'zh',  # Source language: Chinese
                'tl': 'en',  # Target language: English
                'dt': 't',   # Translation type
                'q': text
            }
            
            response = requests.get(self.translate_url, params=params, timeout=10)
            response.raise_for_status()
            
            # Parse the response
            data = response.json()
            if data and len(data) > 0 and len(data[0]) > 0:
                # Extract the translated text
                translated_parts = []
                for part in data[0]:
                    if part[0]:  # The translated text
                        translated_parts.append(part[0])
                
                translation = ''.join(translated_parts)
                return translation.strip()
            else:
                raise Exception("No translation data received")
                
        except requests.RequestException as e:
            print(f"Translation API error: {e}")
            raise e
        except Exception as e:
            print(f"Translation parsing error: {e}")
            raise e
    
    def _fallback_translation(self, text: str) -> str:
        """Fallback translation using basic character dictionary"""
        # Basic character translations for fallback
        character_dict = {
            '一': 'one',
            '三': 'three',
            '上': 'superior',
            '下': 'Down',
            '不': 'No',
            '且': 'and',
            '世': 'World',
            '中': 'middle',
            '丹': 'Dan',
            '主': 'host',
            '之': 'Of',
            '也': 'also',
            '亂': 'Misfortune',
            '了': 'It\'s',
            '事': 'thing',
            '二': 'two',
            '五': 'five',
            '些': 'some',
            '人': 'people',
            '今': 'now',
            '他': 'he',
            '代': 'generation',
            '以': 'by',
            '件': 'Parts',
            '任': 'appoint',
            '份': 'share',
            '但': 'but',
            '位': 'Bit',
            '低': 'Low',
            '住': 'live',
            '何': 'what',
            '佛': 'Buddha',
            '作': 'do',
            '你': 'you',
            '使': 'make',
            '來': 'Come',
            '便': 'Hope',
            '係': '可',
            '保': 'Save',
            '信': 'letter',
            '修': 'build',
            '個': 'Piece',
            '們': '可',
            '倒': 'fall',
            '候': 'Wait',
            '假': 'Fake',
            '做': 'Do',
            '健': 'Healthy',
            '傳': '英',
            '像': 'picture',
            '允': 'allow',
            '元': 'Yuan',
            '先': 'First',
            '光': 'Light',
            '兒': '告',
            '入': 'enter',
            '內': 'Inside',
            '全': 'Complete',
            '兩': 'two',
            '八': 'eight',
            '其': 'That',
            '具': 'Tool',
            '再': 'Again',
            '出': 'out',
            '分': 'point',
            '切': 'cut',
            '別': 'No',
            '利': 'profit',
            '到': 'arrive',
            '制': 'system',
            '前': 'forward',
            '剛': 'So',
            '副': 'vice',
            '力': 'force',
            '功': 'achievement',
            '加': 'add',
            '動': 'move',
            '化': 'change',
            '十': 'ten',
            '千': 'thousand',
            '危': 'Danger',
            '卻': 'Already',
            '原': 'Original',
            '去': 'go',
            '又': 'again',
            '反': 'opposite',
            '受': 'by',
            '口': 'mouth',
            '古': 'antiquity',
            '句': 'sentence',
            '另': 'Other',
            '只': 'Only',
            '叫': 'Call',
            '可': 'Can',
            '史': 'history',
            '吃': 'eat',
            '各': 'each',
            '合': 'combine',
            '同': 'same',
            '名': 'name',
            '向': 'Towards',
            '吧': 'Bar',
            '呀': 'ah',
            '告': 'tell',
            '呢': 'Woolen cloth',
            '周': 'week',
            '命': 'life',
            '和': 'and',
            '員': 'Member',
            '哪': 'where',
            '啊': 'ah',
            '問': 'Ask',
            '啥': 'What',
            '善': 'good',
            '單': 'single',
            '嗎': 'Is it',
            '嚴': 'Serious',
            '四': 'Four',
            '回': 'Back',
            '因': 'because',
            '國': 'country',
            '圍': 'Circle',
            '在': 'exist',
            '地': 'land',
            '坐': 'sit',
            '執': 'Yes',
            '基': 'base',
            '場': 'Story',
            '塊': 'Block',
            '境': 'territory',
            '壞': 'bad',
            '外': 'outside',
            '多': 'many',
            '夠': '１１１１１１１１１１',
            '大': 'big',
            '天': 'sky',
            '太': 'too',
            '失': 'lose',
            '奇': 'strange',
            '套': 'set',
            '女': 'female',
            '好': 'good',
            '如': 'like',
            '始': 'beginning',
            '子': 'son',
            '字': 'Character',
            '存': 'live',
            '學': 'learn',
            '它': 'it',
            '宇': 'Yu',
            '完': 'over',
            '宗': 'Clan',
            '宙': 'universe',
            '定': 'Certainly',
            '害': 'Harmful',
            '家': 'Home',
            '容': 'Allow',
            '密': 'dense',
            '實': 'Really',
            '寫': 'write',
            '將': 'will',
            '對': 'right',
            '導': 'Direct',
            '小': 'Small',
            '少': 'few',
            '尚': 'still',
            '就': 'At once',
            '尼': 'Ni',
            '展': 'exhibition',
            '層': 'Level',
            '屬': '南',
            '工': 'work',
            '差': 'Difference',
            '己': 'It\'s own',
            '已': 'already',
            '師': 'Guy',
            '帶': 'belt',
            '常': 'often',
            '幫': 'Help',
            '干': 'Dry',
            '平': 'flat',
            '年': 'Year',
            '幹': 'Do',
            '幾': 'Quite',
            '底': 'end',
            '度': 'Spend',
            '式': 'Mode',
            '弟': 'younger brother',
            '強': 'Strong',
            '形': 'shape',
            '影': 'film',
            '往': 'Past',
            '很': 'very',
            '後': 'back',
            '得': 'have to',
            '從': 'from',
            '微': 'micro',
            '德': 'De',
            '心': 'Heart',
            '必': 'must',
            '忍': 'Tolerate',
            '快': 'quick',
            '念': 'read',
            '怎': 'How',
            '怕': 'Afraid',
            '思': 'think',
            '性': 'sex',
            '息': 'interest',
            '悟': 'Enlightenment',
            '悲': 'sad',
            '情': 'Affection',
            '想': 'think',
            '意': 'meaning',
            '感': 'feel',
            '態': '未分',
            '慢': 'slow',
            '慾': 'Desire',
            '應': 'Should',
            '成': 'become',
            '我': 'I',
            '或': 'or',
            '所': 'Place',
            '手': 'hand',
            '才': 'talent',
            '打': 'beat',
            '找': 'try to find',
            '承': 'Inherited',
            '把': 'Bundle',
            '拿': 'take',
            '持': 'hold',
            '指': 'refer to',
            '按': 'according to',
            '挺': 'quite',
            '掉': 'Lose',
            '排': 'Row',
            '採': 'Stop',
            '接': 'catch',
            '推': 'push',
            '提': 'carry',
            '握': 'grip',
            '搞': 'Do it',
            '擾': 'Stop',
            '改': 'change',
            '放': 'put',
            '教': 'teach',
            '敢': 'dare',
            '整': 'all',
            '數': 'Number',
            '文': 'arts',
            '新': 'new',
            '斷': 'Cut',
            '方': 'square',
            '於': 'At',
            '明': 'bright',
            '易': 'easy',
            '是': 'yes',
            '時': 'Hour',
            '普': 'general',
            '更': 'Even',
            '書': 'Book',
            '最': 'most',
            '會': 'Can',
            '有': 'have',
            '服': 'Clothes',
            '望': 'see',
            '期': 'Expect',
            '本': 'Book',
            '東': 'east',
            '果': 'fruit',
            '根': 'root',
            '條': 'Rule',
            '業': '未分',
            '極': '南',
            '構': 'Structure',
            '標': 'Tags',
            '樣': 'Like',
            '機': 'Machine',
            '次': 'Second-rate',
            '正': 'just',
            '步': 'step',
            '歷': 'Experience',
            '死': 'die',
            '殺': 'Kill',
            '每': 'Every',
            '比': 'Compare',
            '氣': 'Fresh',
            '水': 'water',
            '求': 'beg',
            '決': 'Decide',
            '沒': 'not',
            '治': 'rule',
            '況': 'Quite',
            '法': 'Law',
            '活': 'live',
            '消': 'remove',
            '淨': 'Pure',
            '深': 'deep',
            '清': 'clear',
            '準': '未分',
            '滅': '可',
            '滿': '可',
            '演': 'play',
            '漸': '未分',
            '灌': 'Injection',
            '火': 'fire',
            '為': 'for',
            '無': 'without',
            '然': 'Of course',
            '煉': '未分',
            '照': 'According to',
            '爭': 'Confrontation',
            '父': 'father',
            '牟': 'Mou',
            '物': 'Things',
            '特': 'special',
            '狀': '南',
            '玄': 'mysterious',
            '班': 'class',
            '現': 'Now',
            '理': 'reason',
            '環': '可',
            '甚': 'very',
            '生': 'born',
            '產': 'Production',
            '用': 'use',
            '田': 'field',
            '由': 'Depend on',
            '界': 'boundary',
            '當': 'when',
            '病': 'sick',
            '發': 'send',
            '白': 'white',
            '百': 'Hundred',
            '的': 'of',
            '益': 'beneficial',
            '目': 'Meaning',
            '直': 'straight',
            '相': 'Mutually',
            '盾': 'shield',
            '看': 'look',
            '真': 'real',
            '眼': 'Eye',
            '睛': 'eye',
            '矛': 'spear',
            '知': 'Know',
            '研': 'research',
            '破': 'break',
            '確': 'OK',
            '示': 'Show',
            '社': 'society',
            '祛': 'remove',
            '神': 'god',
            '科': 'division',
            '程': 'Procedure',
            '種': 'Type',
            '積': '南',
            '究': 'Investigate',
            '空': 'null',
            '突': 'sudden',
            '第': 'The',
            '等': 'wait',
            '算': 'Calculate',
            '管': 'Tube',
            '簡': 'Simplified',
            '精': 'Refined',
            '細': 'Details',
            '結': 'End',
            '絕': 'Indestructible',
            '給': 'give',
            '經': 'By',
            '練': 'Practice',
            '義': 'Yi',
            '翻': 'turn',
            '老': 'old',
            '者': 'Those',
            '而': 'and',
            '聽': 'hear',
            '肉': 'Meat',
            '胞': 'Cell',
            '能': 'able',
            '脈': '可',
            '腦': 'Brain',
            '自': 'since',
            '至': 'to',
            '與': 'and',
            '興': 'Enjoy',
            '舉': '可',
            '舒': 'Sweet',
            '般': 'Normal',
            '色': 'color',
            '花': 'flower',
            '苦': 'bitter',
            '華': '未分',
            '萬': 'ten thousand',
            '著': 'write',
            '處': 'No',
            '行': 'OK',
            '術': 'Aesthetics',
            '衡': 'Heng',
            '表': 'surface',
            '被': 'quilt',
            '裏': '可',
            '西': 'West',
            '要': 'want',
            '見': 'See',
            '視': 'View',
            '覺': 'Feel',
            '觀': 'View',
            '解': 'untie',
            '許': 'Worth',
            '訴': 'Worry',
            '話': 'talk',
            '該': 'That',
            '認': 'Recognize',
            '說': 'say',
            '誰': 'who',
            '談': 'Talk about it',
            '講': 'Talk',
            '證': 'Certificate',
            '識': 'Know',
            '變': 'Change',
            '讓': 'let',
            '象': 'elephant',
            '財': 'Certificate',
            '質': 'Quality',
            '走': 'Walk',
            '起': 'rise',
            '超': 'overtake',
            '越': 'cross',
            '跑': 'run',
            '跟': 'and',
            '路': 'road',
            '身': 'body',
            '車': 'vehicle',
            '較': 'More',
            '輕': 'Light',
            '輪': 'Wheel',
            '轉': 'Turn',
            '辦': 'Order',
            '返': 'return',
            '迦': 'Ka',
            '迷': 'fan',
            '追': 'Chase',
            '這': 'This',
            '通': 'Pass',
            '造': 'make',
            '連': '小',
            '進': 'In',
            '遇': 'Meet',
            '運': 'Run',
            '過': 'pass',
            '道': 'road',
            '達': 'De',
            '遠': 'Far',
            '還': 'Also',
            '邊': 'Next',
            '那': 'That',
            '邪': 'evil',
            '部': 'department',
            '都': 'All',
            '醫': 'Medical',
            '釋': '未分类',
            '重': 'Heavy',
            '量': 'quantity',
            '金': 'gold',
            '錢': 'money',
            '錯': 'mistaken',
            '長': 'long',
            '門': 'door',
            '開': 'open',
            '間': 'between',
            '關': 'shut',
            '附': 'Attached',
            '院': 'hospital',
            '除': 'remove',
            '隨': '可',
            '雙': 'pair',
            '雜': 'Difficult',
            '離': 'Leave',
            '難': 'difficult',
            '電': 'Electricity',
            '靈': 'Spirit',
            '靜': 'Calm',
            '非': 'No',
            '面': 'noodle',
            '頂': '６',
            '須': 'Must',
            '頭': 'head',
            '顆': '未分',
            '題': 'Question',
            '類': 'Category',
            '顯': 'Show',
            '馬': 'Horse',
            '體': 'Body',
            '高': 'high',
            '鬥': 'Fight',
            '魔': 'magic',
            '麼': 'Yes',
            '黑': 'black',
            '點': 'point',
        }
        
        result = []
        for char in text:
            if char in char_dict:
                result.append(char_dict[char])
            else:
                result.append(char)
        
        translation = ' '.join(result)
        if translation:
            translation = translation[0].upper() + translation[1:]
        return translation
    
    def translate_character_by_character(self, text: str) -> List[Dict[str, str]]:
        """Translate text character by character"""
        result = []
        for char in text:
            if '\u4e00' <= char <= '\u9fff':  # Chinese character range
                # For character-by-character, use the fallback dictionary
                char_dict = {
                    '轉': 'turn, rotate', '法': 'law, method', '輪': 'wheel, round',
                    '李': 'plum', '洪': 'flood, vast', '志': 'will, purpose',
                    '目': 'eye, item', '錄': 'record, copy', '論': 'discuss, theory',
                    '語': 'language, speech', '第': 'sequence, number', '一': 'one',
                    '講': 'speak, lecture', '真': 'true, real', '正': 'correct, right',
                    '往': 'go, toward', '高': 'high, tall', '層': 'layer, level',
                    '次': 'time, order', '上': 'up, above', '帶': 'bring, lead',
                    '人': 'person, human', '不': 'not, no', '同': 'same, together',
                    '有': 'have, exist', '善': 'good, kind', '忍': 'endure, patience',
                    '是': 'is, are', '衡': 'balance, measure', '量': 'measure, quantity',
                    '好': 'good, well', '壞': 'bad, broken', '唯': 'only, unique',
                    '標': 'mark, sign', '準': 'accurate, standard', '氣': 'qi, energy',
                    '功': 'merit, achievement', '史': 'history', '前': 'before, front',
                    '文': 'writing, culture', '化': 'change, transform', '就': 'just, then',
                    '修': 'cultivate, repair', '煉': 'refine, practice', '為': 'for, as',
                    '甚': 'what, why', '麼': 'particle', '長': 'long, grow',
                    '特': 'special, particular', '點': 'point, dot',
                    '我': 'I, me', '在': 'at, in', '整': 'whole, complete', '個': 'individual, piece',
                    '傳': 'transmit, pass on', '過': 'pass, go through', '程': 'process, journey',
                    '中': 'middle, center', '本': 'root, origin', '著': 'particle, aspect',
                    '對': 'toward, correct', '社': 'society', '會': 'meeting, society',
                    '負': 'bear, carry', '責': 'responsibility', '學': 'learn, study',
                    '員': 'member, person', '收': 'receive, collect', '到': 'arrive, reach',
                    '的': 'possessive particle', '效': 'effect, result', '果': 'fruit, result',
                    '影': 'shadow, image', '響': 'sound, influence', '也': 'also, too',
                    '比': 'compare, than', '較': 'compare, relatively'
                }
                translation = char_dict.get(char, 'Unknown')
                result.append({
                    'character': char,
                    'translation': translation
                })
            else:
                result.append({
                    'character': char,
                    'translation': char
                })
        return result
    
    def get_phrase_translation(self, phrase: str) -> str:
        """Get translation for a specific phrase"""
        return self.common_phrases.get(phrase, 'Translation not available')
    
    def get_character_fallback(self, char: str) -> str:
        """Get fallback translation for a single character from local dictionary"""
        
        character_dict = {
            '一': 'one',
            '三': 'three',
            '上': 'superior',
            '下': 'Down',
            '不': 'No',
            '且': 'and',
            '世': 'World',
            '中': 'middle',
            '丹': 'Dan',
            '主': 'host',
            '之': 'Of',
            '也': 'also',
            '亂': 'Misfortune',
            '了': 'It\'s',
            '事': 'thing',
            '二': 'two',
            '五': 'five',
            '些': 'some',
            '人': 'people',
            '今': 'now',
            '他': 'he',
            '代': 'generation',
            '以': 'by',
            '件': 'Parts',
            '任': 'appoint',
            '份': 'share',
            '但': 'but',
            '位': 'Bit',
            '低': 'Low',
            '住': 'live',
            '何': 'what',
            '佛': 'Buddha',
            '作': 'do',
            '你': 'you',
            '使': 'make',
            '來': 'Come',
            '便': 'Hope',
            '係': '可',
            '保': 'Save',
            '信': 'letter',
            '修': 'build',
            '個': 'Piece',
            '們': '可',
            '倒': 'fall',
            '候': 'Wait',
            '假': 'Fake',
            '做': 'Do',
            '健': 'Healthy',
            '傳': '英',
            '像': 'picture',
            '允': 'allow',
            '元': 'Yuan',
            '先': 'First',
            '光': 'Light',
            '兒': '告',
            '入': 'enter',
            '內': 'Inside',
            '全': 'Complete',
            '兩': 'two',
            '八': 'eight',
            '其': 'That',
            '具': 'Tool',
            '再': 'Again',
            '出': 'out',
            '分': 'point',
            '切': 'cut',
            '別': 'No',
            '利': 'profit',
            '到': 'arrive',
            '制': 'system',
            '前': 'forward',
            '剛': 'So',
            '副': 'vice',
            '力': 'force',
            '功': 'achievement',
            '加': 'add',
            '動': 'move',
            '化': 'change',
            '十': 'ten',
            '千': 'thousand',
            '危': 'Danger',
            '卻': 'Already',
            '原': 'Original',
            '去': 'go',
            '又': 'again',
            '反': 'opposite',
            '受': 'by',
            '口': 'mouth',
            '古': 'antiquity',
            '句': 'sentence',
            '另': 'Other',
            '只': 'Only',
            '叫': 'Call',
            '可': 'Can',
            '史': 'history',
            '吃': 'eat',
            '各': 'each',
            '合': 'combine',
            '同': 'same',
            '名': 'name',
            '向': 'Towards',
            '吧': 'Bar',
            '呀': 'ah',
            '告': 'tell',
            '呢': 'Woolen cloth',
            '周': 'week',
            '命': 'life',
            '和': 'and',
            '員': 'Member',
            '哪': 'where',
            '啊': 'ah',
            '問': 'Ask',
            '啥': 'What',
            '善': 'good',
            '單': 'single',
            '嗎': 'Is it',
            '嚴': 'Serious',
            '四': 'Four',
            '回': 'Back',
            '因': 'because',
            '國': 'country',
            '圍': 'Circle',
            '在': 'exist',
            '地': 'land',
            '坐': 'sit',
            '執': 'Yes',
            '基': 'base',
            '場': 'Story',
            '塊': 'Block',
            '境': 'territory',
            '壞': 'bad',
            '外': 'outside',
            '多': 'many',
            '夠': 'enough',
            '大': 'big',
            '天': 'sky',
            '太': 'too',
            '失': 'lose',
            '奇': 'strange',
            '套': 'set',
            '女': 'female',
            '好': 'good',
            '如': 'like',
            '始': 'beginning',
            '子': 'son',
            '字': 'Character',
            '存': 'live',
            '學': 'learn',
            '它': 'it',
            '宇': 'Yu',
            '完': 'over',
            '宗': 'Clan',
            '宙': 'universe',
            '定': 'Certainly',
            '害': 'Harmful',
            '家': 'Home',
            '容': 'Allow',
            '密': 'dense',
            '實': 'Really',
            '寫': 'write',
            '將': 'will',
            '對': 'right',
            '導': 'Direct',
            '小': 'Small',
            '少': 'few',
            '尚': 'still',
            '就': 'At once',
            '尼': 'Ni',
            '展': 'exhibition',
            '層': 'Level',
            '屬': '南',
            '工': 'work',
            '差': 'Difference',
            '己': 'It\'s own',
            '已': 'already',
            '師': 'Guy',
            '帶': 'belt',
            '常': 'often',
            '幫': 'Help',
            '干': 'Dry',
            '平': 'flat',
            '年': 'Year',
            '幹': 'Do',
            '幾': 'Quite',
            '底': 'end',
            '度': 'Spend',
            '式': 'Mode',
            '弟': 'younger brother',
            '強': 'Strong',
            '形': 'shape',
            '影': 'film',
            '往': 'Past',
            '很': 'very',
            '後': 'back',
            '得': 'have to',
            '從': 'from',
            '微': 'micro',
            '德': 'De',
            '心': 'Heart',
            '必': 'must',
            '忍': 'Tolerate',
            '快': 'quick',
            '念': 'read',
            '怎': 'How',
            '怕': 'Afraid',
            '思': 'think',
            '性': 'sex',
            '息': 'interest',
            '悟': 'Enlightenment',
            '悲': 'sad',
            '情': 'Affection',
            '想': 'think',
            '意': 'meaning',
            '感': 'feel',
            '態': '未分',
            '慢': 'slow',
            '慾': 'Desire',
            '應': 'Should',
            '成': 'become',
            '我': 'I',
            '或': 'or',
            '所': 'Place',
            '手': 'hand',
            '才': 'talent',
            '打': 'beat',
            '找': 'try to find',
            '承': 'Inherited',
            '把': 'Bundle',
            '拿': 'take',
            '持': 'hold',
            '指': 'refer to',
            '按': 'according to',
            '挺': 'quite',
            '掉': 'Lose',
            '排': 'Row',
            '採': 'Stop',
            '接': 'catch',
            '推': 'push',
            '提': 'carry',
            '握': 'grip',
            '搞': 'Do it',
            '擾': 'Stop',
            '改': 'change',
            '放': 'put',
            '教': 'teach',
            '敢': 'dare',
            '整': 'all',
            '數': 'Number',
            '文': 'arts',
            '新': 'new',
            '斷': 'Cut',
            '方': 'square',
            '於': 'At',
            '明': 'bright',
            '易': 'easy',
            '是': 'yes',
            '時': 'Hour',
            '普': 'general',
            '更': 'Even',
            '書': 'Book',
            '最': 'most',
            '會': 'Can',
            '有': 'have',
            '服': 'Clothes',
            '望': 'see',
            '期': 'Expect',
            '本': 'Book',
            '東': 'east',
            '果': 'fruit',
            '根': 'root',
            '條': 'Rule',
            '業': '未分',
            '極': '南',
            '構': 'Structure',
            '標': 'Tags',
            '樣': 'Like',
            '機': 'Machine',
            '次': 'Second-rate',
            '正': 'just',
            '步': 'step',
            '歷': 'Experience',
            '死': 'die',
            '殺': 'Kill',
            '每': 'Every',
            '比': 'Compare',
            '氣': 'Fresh',
            '水': 'water',
            '求': 'beg',
            '決': 'Decide',
            '沒': 'not',
            '治': 'rule',
            '況': 'Quite',
            '法': 'Law',
            '活': 'live',
            '消': 'remove',
            '淨': 'Pure',
            '深': 'deep',
            '清': 'clear',
            '準': '未分',
            '滅': '可',
            '滿': '可',
            '演': 'play',
            '漸': '未分',
            '灌': 'Injection',
            '火': 'fire',
            '為': 'for',
            '無': 'without',
            '然': 'Of course',
            '煉': '未分',
            '照': 'According to',
            '爭': 'Confrontation',
            '父': 'father',
            '牟': 'Mou',
            '物': 'Things',
            '特': 'special',
            '狀': '南',
            '玄': 'mysterious',
            '班': 'class',
            '現': 'Now',
            '理': 'reason',
            '環': '可',
            '甚': 'very',
            '生': 'born',
            '產': 'Production',
            '用': 'use',
            '田': 'field',
            '由': 'Depend on',
            '界': 'boundary',
            '當': 'when',
            '病': 'sick',
            '發': 'send',
            '白': 'white',
            '百': 'Hundred',
            '的': 'of',
            '益': 'beneficial',
            '目': 'Meaning',
            '直': 'straight',
            '相': 'Mutually',
            '盾': 'shield',
            '看': 'look',
            '真': 'real',
            '眼': 'Eye',
            '睛': 'eye',
            '矛': 'spear',
            '知': 'Know',
            '研': 'research',
            '破': 'break',
            '確': 'OK',
            '示': 'Show',
            '社': 'society',
            '祛': 'remove',
            '神': 'god',
            '科': 'division',
            '程': 'Procedure',
            '種': 'Type',
            '積': '南',
            '究': 'Investigate',
            '空': 'null',
            '突': 'sudden',
            '第': 'The',
            '等': 'wait',
            '算': 'Calculate',
            '管': 'Tube',
            '簡': 'Simplified',
            '精': 'Refined',
            '細': 'Details',
            '結': 'End',
            '絕': 'Indestructible',
            '給': 'give',
            '經': 'By',
            '練': 'Practice',
            '義': 'Yi',
            '翻': 'turn',
            '老': 'old',
            '者': 'Those',
            '而': 'and',
            '聽': 'hear',
            '肉': 'Meat',
            '胞': 'Cell',
            '能': 'able',
            '脈': '可',
            '腦': 'Brain',
            '自': 'since',
            '至': 'to',
            '與': 'and',
            '興': 'Enjoy',
            '舉': '可',
            '舒': 'Sweet',
            '般': 'Normal',
            '色': 'color',
            '花': 'flower',
            '苦': 'bitter',
            '華': '未分',
            '萬': 'ten thousand',
            '著': 'write',
            '處': 'No',
            '行': 'OK',
            '術': 'Aesthetics',
            '衡': 'Heng',
            '表': 'surface',
            '被': 'quilt',
            '裏': '可',
            '西': 'West',
            '要': 'want',
            '見': 'See',
            '視': 'View',
            '覺': 'Feel',
            '觀': 'View',
            '解': 'untie',
            '許': 'Worth',
            '訴': 'Worry',
            '話': 'talk',
            '該': 'That',
            '認': 'Recognize',
            '說': 'say',
            '誰': 'who',
            '談': 'Talk about it',
            '講': 'Talk',
            '證': 'Certificate',
            '識': 'Know',
            '變': 'Change',
            '讓': 'let',
            '象': 'elephant',
            '財': 'Certificate',
            '質': 'Quality',
            '走': 'Walk',
            '起': 'rise',
            '超': 'overtake',
            '越': 'cross',
            '跑': 'run',
            '跟': 'and',
            '路': 'road',
            '身': 'body',
            '車': 'vehicle',
            '較': 'More',
            '輕': 'Light',
            '輪': 'Wheel',
            '轉': 'Turn',
            '辦': 'Order',
            '返': 'return',
            '迦': 'Ka',
            '迷': 'fan',
            '追': 'Chase',
            '這': 'This',
            '通': 'Pass',
            '造': 'make',
            '連': '小',
            '進': 'In',
            '遇': 'Meet',
            '運': 'Run',
            '過': 'pass',
            '道': 'road',
            '達': 'De',
            '遠': 'Far',
            '還': 'Also',
            '邊': 'Next',
            '那': 'That',
            '邪': 'evil',
            '部': 'department',
            '都': 'All',
            '醫': 'Medical',
            '釋': '未分类',
            '重': 'Heavy',
            '量': 'quantity',
            '金': 'gold',
            '錢': 'money',
            '錯': 'mistaken',
            '長': 'long',
            '門': 'door',
            '開': 'open',
            '間': 'between',
            '關': 'shut',
            '附': 'Attached',
            '院': 'hospital',
            '除': 'remove',
            '隨': '可',
            '雙': 'pair',
            '雜': 'Difficult',
            '離': 'Leave',
            '難': 'difficult',
            '電': 'Electricity',
            '靈': 'Spirit',
            '靜': 'Calm',
            '非': 'No',
            '面': 'noodle',
            '頂': '６',
            '須': 'Must',
            '頭': 'head',
            '顆': '未分',
            '題': 'Question',
            '類': 'Category',
            '顯': 'Show',
            '馬': 'Horse',
            '體': 'Body',
            '高': 'high',
            '鬥': 'Fight',
            '魔': 'magic',
            '麼': 'Yes',
            '黑': 'black',
            '點': 'point',
        
        }
        return character_dict.get(char, 'Unknown')
    
    def get_phrase_fallback(self, phrase: str) -> str:
        """Get fallback translation for a multi-character phrase from local dictionary"""
        # Paste the phrase_dict content from expanded_phrase_dictionary.py here
        phrase_dict = {
            '一下': 'one time',
            '一下子': 'all of a sudden',
            '一些': 'Some',
            '一個': 'A',
            '一切': 'everything',
            '一天': 'one day',
            '一定': 'must',
            '一旦': 'once',
            '一樣': 'Same',
            '一步': 'step',
            '一直': 'Always',
            '一看': 'Take a look',
            '一種': 'A kind',
            '一般': 'generally',
            '一點': 'A little',
            '上來': 'Come up',
            '上去': 'Go up',
            '下來': 'Next',
            '下去': 'Go down',
            '不了': 'No',
            '不到': 'Less than',
            '不同': 'different',
            '不好': 'not good',
            '不得': 'No',
            '不想': 'In no mood',
            '不敢': 'Don\'t dare',
            '不斷': 'Continuous',
            '不是': 'no',
            '不會': 'will not',
            '不管': 'in spite of',
            '不能': 'cannot',
            '不行': 'no',
            '不要': 'don\'t want',
            '不見': 'Miss',
            '不講': 'No comment',
            '世界': 'world',
            '中國': 'China',
            '丹田': 'Dantian',
            '主元神': 'The Lord of the Spirit',
            '主要': 'main',
            '之間': 'Between',
            '也好': 'Good too',
            '事情': 'matter',
            '人人': 'Everyone',
            '人們': 'People',
            '人家': 'Others',
            '人類': 'Human',
            '人體': 'Human body',
            '今天': 'today',
            '他們': 'them',
            '任何': 'any',
            '但是': 'but',
            '佛像': 'Buddha statue',
            '佛家': 'Buddhism',
            '佛教': 'Buddhism',
            '佛法': 'Buddhism',
            '作為': 'As',
            '作用': 'effect',
            '例子': 'example',
            '保證': 'guarantee',
            '信息': 'information',
            '修煉': 'Renovation',
            '傳功': 'Convey the power',
            '允許': 'Allow',
            '全部': 'all',
            '其它': 'other',
            '其實': 'actually',
            '出來': 'Come out',
            '出去': 'go out',
            '出現': 'appear',
            '分子': 'molecular',
            '別人': 'Others',
            '利益': 'Benefit',
            '功師': 'Master',
            '功法': 'Practice',
            '功能': 'Function',
            '危險': 'danger',
            '去掉': 'Remove',
            '另外': 'in addition',
            '只是': 'only',
            '只有': 'only',
            '只能': 'Only',
            '只要': 'if only',
            '叫作': 'Called',
            '可以': 'Can',
            '可是': 'But',
            '可能': 'possible',
            '吃苦': 'Suffering',
            '各個': 'Each',
            '各種': 'Various',
            '同時': 'At the same time',
            '告訴': 'Tell me',
            '和尚': 'Monk',
            '哪個': 'Which one',
            '問題': 'problem',
            '回事': 'It\'s true',
            '因為': 'Because',
            '地方': 'place',
            '坐在': 'Sit on',
            '執著': 'Enforced',
            '執著心': 'Hold your heart',
            '多多': 'Duoduo',
            '多少': 'How many',
            '大家': 'Everyone',
            '大法': 'Great method',
            '大腦': 'Big brain',
            '天目': 'Tianmu',
            '好像': 'like',
            '如何': 'how',
            '如果': 'if',
            '存在': 'exist',
            '學員': 'Student',
            '宇宙': 'universe',
            '完全': 'completely',
            '宗教': 'religion',
            '容易': 'easy',
            '將來': 'Will come',
            '就是': 'that is',
            '就要': 'Just want',
            '層次': 'Levels',
            '已經': 'already',
            '師父': 'Master\'s father',
            '常人': 'Ordinary people',
            '干擾': 'Interference',
            '弟子': 'disciple',
            '形式': 'form',
            '形成': 'form',
            '往往': 'often',
            '很多': 'a lot of',
            '很大': 'Very big',
            '得到': 'get',
            '心性': 'Mind',
            '必須': 'Must be',
            '怎麼': 'How',
            '思想': 'Thought',
            '悟性': 'Enlightenment',
            '情況': 'condition',
            '想一想': 'Think about it',
            '想要': 'want to',
            '意念': 'idea',
            '意思': 'mean',
            '意識': 'Idea',
            '感覺': 'feel',
            '慢慢': 'Slowly',
            '應該': 'should',
            '成度': 'Cultivation',
            '我們': 'we',
            '我給': 'I\'ll give',
            '我講': 'I\'m saying',
            '或者': 'or',
            '所以': 'so',
            '所有': 'all',
            '才能': 'Talent',
            '打坐': 'Meditation',
            '把握': 'grasp',
            '按照': 'according to',
            '控制': 'control',
            '提高': 'improve',
            '改變': 'Change',
            '放不下': 'Can\'t let go',
            '整個': 'The whole',
            '方法': 'method',
            '明白': 'clear',
            '是不是': 'Yes or no',
            '時候': 'At the moment',
            '時期': 'Time',
            '時間': 'time',
            '有些': 'some',
            '有人': 'Someone',
            '本事': 'ability',
            '東西': 'Something',
            '根基': 'Foundation',
            '根本': 'fundamental',
            '業力': 'Business ability',
            '極其': 'Extremely',
            '標準': 'standard',
            '正法': 'The Dharma',
            '歷史': 'History',
            '氣功': 'Aura',
            '氣功師': 'Qigong master',
            '沒有': 'no',
            '治病': 'Treatment',
            '法身': 'Dharma body',
            '法輪': 'Frame',
            '法門': 'Dharma door',
            '活動': 'Activity',
            '演化': 'evolution',
            '煉功': 'Responsible',
            '物質': 'Material',
            '特別': 'very',
            '特性': 'characteristic',
            '特殊': 'special',
            '狀態': 'condition',
            '現在': 'now',
            '現象': 'Activity',
            '理解': 'understand',
            '環境': 'environment',
            '甚至': 'even',
            '甚麼': 'What',
            '生命': 'life',
            '產生': 'Generate',
            '當中': 'In',
            '當時': 'At that time',
            '當然': 'Of course',
            '發出': 'Posted',
            '發展': 'developing',
            '發現': 'discover',
            '發生': 'happen',
            '目地': 'Destination',
            '直接': 'direct',
            '相信': 'believe',
            '相當': 'Quite awesome',
            '看不到': 'Can\'t see',
            '看到': 'See',
            '真善忍': 'Truthfulness, Compassion, Forbearance',
            '真正': 'real',
            '真的': 'real',
            '眼睛': 'Eye',
            '矛盾': 'contradiction',
            '知道': 'Know',
            '研究': 'Research',
            '破壞': 'destroy',
            '社會': 'society',
            '祛病健身': 'Relieve diseases and improve health',
            '科學': 'Science',
            '空間': 'Space',
            '突然': 'Sudden',
            '等等': 'etc.',
            '簡直': 'Simple',
            '細胞': 'Cell',
            '絕對': 'Extremely',
            '給你': 'Give it to you',
            '經過': 'pass',
            '練功': 'Practice',
            '老師': 'teacher',
            '而且': 'and',
            '能夠': 'Can',
            '能量': 'energy',
            '自己': 'Own',
            '衡量': 'measure',
            '要是': 'if',
            '要求': 'Require',
            '覺者': 'Perceptionist',
            '許多': 'Many',
            '許多人': 'Many people',
            '許許': 'Xu',
            '認為': 'think',
            '認識': 'know',
            '講出': 'Tell me',
            '講的': 'Talk',
            '變化': 'Change',
            '起來': 'Get up',
            '身上': 'Body',
            '身體': 'body',
            '轉化': 'Transformation',
            '追求': 'Pursue',
            '這一法門': 'This method door',
            '這一點': 'This is',
            '這些': 'These',
            '這件': 'This piece',
            '這個': 'this',
            '這是': 'This is',
            '這樣': 'This is',
            '這種': 'This kind',
            '這麼': 'This',
            '造成': 'cause',
            '遇到': 'meet',
            '過來': 'Come',
            '過去': 'Past',
            '過程': 'Process',
            '道家': 'Taoism',
            '道德': 'Morality',
            '道理': 'reason',
            '達到': 'Reach',
            '還得': 'Still need',
            '還是': 'Still',
            '還有': 'and',
            '還要': 'Also',
            '那些': 'Those ones',
            '那個': 'That',
            '那兒': 'That',
            '那樣': 'That\'s it',
            '那種': 'That kind',
            '那麼': 'Then',
            '醫院': 'hospital',
            '釋迦': '黑址',
            '釋迦牟尼': 'Kankyamuni',
            '開光': 'Open',
            '開功': 'Energize',
            '開始': 'Start',
            '附體': 'Appendix',
            '隨著': 'By',
            '雙修': 'Double repair',
            '難受': 'Difficult to suffer',
            '非常': 'Very',
            '顯示': 'Show',
            '高層次': 'High-level',
            '高能量': 'High energy',
            '高興': 'Gao Xing',
            '黑色': 'black',
        }
        return phrase_dict.get(phrase, 'Unknown')
